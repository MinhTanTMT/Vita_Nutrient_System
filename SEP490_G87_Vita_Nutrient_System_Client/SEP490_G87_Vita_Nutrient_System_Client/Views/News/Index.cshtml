@model IEnumerable<SEP490_G87_Vita_Nutrient_System_Client.Models.ArticlesNews>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
<link rel="stylesheet" href="/css/news/index.css" />

<div class="container">
    <h1 class="page-title">Danh sách bài viết</h1>
    <form asp-action="Index" method="get" class="mb-3">
        <div class="input-group">
            <input type="text" name="searchTitle" class="form-control" placeholder="Tìm kiếm theo tiêu đề" value="@ViewData["searchTitle"]" />
            <button type="submit" class="btn btn-primary">Tìm kiếm</button>
        </div>
    </form>
    <p>
        <a asp-action="Create" class="btn btn-primary btn-lg">Tạo bài viết mới</a>
    </p>

    <table class="table custom-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Hình ảnh đầu bài</th>
                <th>Tiêu đề</th>
                <th>Tác giả</th>
                <th>Trạng thái</th>
                <th>Ngày tạo</th>
                <th>Đánh giá</th>
                <th style ="text-align: center;">Hành động</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var article in Model)
            {
                <tr>
                    <td>@article.Id</td>
                    <td>
                        @if (!string.IsNullOrEmpty(article.HeaderImage))
                        {
                            <img src="@article.HeaderImage" alt="Header Image" class="article-image" />
                        }
                        else
                        {
                            <span>Không có hình ảnh</span>
                        }
                    </td>
                    <td>@article.Title</td>
                    <td>@article.NameCreater</td>
                    <td>
                        <span class="badge @(article.IsActive == true ? "badge-active" : "badge-inactive")">
                            @(article.IsActive == true ? "Hoạt động" : "Không hoạt động")
                        </span>
                    </td>
                    <td>@article.DateCreated?.ToString("dd/MM/yyyy")</td>
                    <td>
                        @if (article.NumberRate > 0)
                        {
                            <div class="star-rating">
                                @{
                                    double roundedRate = Math.Round(article.Rate ?? 0, 2);
                                    int fullStars = (int)Math.Floor(roundedRate);
                                    bool hasHalfStar = (roundedRate % 1) >= 0.5;
                                }

                                @for (int i = 1; i <= 5; i++)
                                {
                                    if (i <= fullStars)
                                    {
                                        <i class="fa fa-star text-warning"></i>
                                    }
                                    else if (i == fullStars + 1 && hasHalfStar)
                                    {
                                        <i class="fa fa-star-half-alt text-warning"></i>
                                    }
                                    else
                                    {
                                        <i class="fa fa-star text-secondary"></i>
                                    }
                                }
                                <p>@roundedRate/5 - (@article.NumberRate bình chọn)</p>
                            </div>
                        }
                        else
                        {
                            <p>Chưa có đánh giá</p>
                        }
                    </td>
                    <td style="text-align: center;">
                        <a class="btn btn-primary btn-sm" asp-action="Details" asp-route-id="@article.Id"><i class="fas fa-eye"></i> Chi tiết</a>
                        <a class="btn btn-warning btn-sm" asp-action="Edit" asp-route-id="@article.Id"><i class="fas fa-edit"></i> Chỉnh sửa</a>
                        <a class="btn btn-danger btn-sm" asp-action="Delete" asp-route-id="@article.Id"><i class="fas fa-trash"></i> Xóa</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

